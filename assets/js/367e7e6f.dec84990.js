"use strict";(self.webpackChunksaga_docs=self.webpackChunksaga_docs||[]).push([[432],{3905:function(e,r,t){t.d(r,{Zo:function(){return p},kt:function(){return k}});var a=t(7294);function n(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function o(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,a)}return t}function i(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?o(Object(t),!0).forEach((function(r){n(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function l(e,r){if(null==e)return{};var t,a,n=function(e,r){if(null==e)return{};var t,a,n={},o=Object.keys(e);for(a=0;a<o.length;a++)t=o[a],r.indexOf(t)>=0||(n[t]=e[t]);return n}(e,r);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)t=o[a],r.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(n[t]=e[t])}return n}var s=a.createContext({}),m=function(e){var r=a.useContext(s),t=r;return e&&(t="function"==typeof e?e(r):i(i({},r),e)),t},p=function(e){var r=m(e.components);return a.createElement(s.Provider,{value:r},e.children)},u={inlineCode:"code",wrapper:function(e){var r=e.children;return a.createElement(a.Fragment,{},r)}},f=a.forwardRef((function(e,r){var t=e.components,n=e.mdxType,o=e.originalType,s=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),f=m(t),k=n,g=f["".concat(s,".").concat(k)]||f[k]||u[k]||o;return t?a.createElement(g,i(i({ref:r},p),{},{components:t})):a.createElement(g,i({ref:r},p))}));function k(e,r){var t=arguments,n=r&&r.mdxType;if("string"==typeof e||n){var o=t.length,i=new Array(o);i[0]=f;var l={};for(var s in r)hasOwnProperty.call(r,s)&&(l[s]=r[s]);l.originalType=e,l.mdxType="string"==typeof e?e:n,i[1]=l;for(var m=2;m<o;m++)i[m]=t[m];return a.createElement.apply(null,i)}return a.createElement.apply(null,t)}f.displayName="MDXCreateElement"},6683:function(e,r,t){t.r(r),t.d(r,{assets:function(){return p},contentTitle:function(){return s},default:function(){return k},frontMatter:function(){return l},metadata:function(){return m},toc:function(){return u}});var a=t(7462),n=t(3366),o=(t(7294),t(3905)),i=["components"],l={},s="Terraform",m={unversionedId:"utvikling-paa-saga/terraform",id:"utvikling-paa-saga/terraform",title:"Terraform",description:'\xc5 sette opp infrastruktur manuelt i GCP er tidkrevende og vanskelig \xe5 reprodusere, spesielt p\xe5 tvers av flere milj\xf8er. For \xe5 automatisere oppsett av infrastruktur bruker vi derfor Terraform fra HashiCorp, et verkt\xf8y for "Infrastructure as Code". Alle ressurser blir definert i Terraform-filer (.tf), sjekkes inn i Git, og kan parameteriseres med ulike variabler per milj\xf8.',source:"@site/docs/03-utvikling-paa-saga/04-terraform.md",sourceDirName:"03-utvikling-paa-saga",slug:"/utvikling-paa-saga/terraform",permalink:"/docs-public/utvikling-paa-saga/terraform",draft:!1,editUrl:"https://github.com/svvsaga/docs-public/edit/main/docs/03-utvikling-paa-saga/04-terraform.md",tags:[],version:"current",sidebarPosition:4,frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Hvordan f\xe5 data inn i Saga",permalink:"/docs-public/utvikling-paa-saga/hvordan-faa-data-inn-i-saga"},next:{title:"GitHub Actions & Workflows",permalink:"/docs-public/utvikling-paa-saga/github-actions"}},p={},u=[{value:"Terragrunt",id:"terragrunt",level:2},{value:"saga-team-template",id:"saga-team-template",level:2},{value:"Import av eksisterende infrastruktur til Terraform",id:"import-av-eksisterende-infrastruktur-til-terraform",level:2},{value:"Alternativer til Terraform",id:"alternativer-til-terraform",level:2}],f={toc:u};function k(e){var r=e.components,t=(0,n.Z)(e,i);return(0,o.kt)("wrapper",(0,a.Z)({},f,t,{components:r,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"terraform"},"Terraform"),(0,o.kt)("p",null,"\xc5 sette opp infrastruktur manuelt i GCP er tidkrevende og vanskelig \xe5 reprodusere, spesielt p\xe5 tvers av flere milj\xf8er. For \xe5 automatisere oppsett av infrastruktur bruker vi derfor ",(0,o.kt)("a",{parentName:"p",href:"https://www.terraform.io/"},"Terraform fra HashiCorp"),', et verkt\xf8y for "Infrastructure as Code". Alle ressurser blir definert i Terraform-filer (.tf), sjekkes inn i Git, og kan parameteriseres med ulike variabler per milj\xf8.'),(0,o.kt)("p",null,"Terraform brukes av Google selv, og det finnes mange gode ressurser for \xe5 l\xe6re seg Terraform:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://cloud.google.com/docs/terraform/get-started-with-terraform"},"GCPs egen Terraform-doc")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://learn.hashicorp.com/collections/terraform/gcp-get-started"},"Terraform med GCP fra hashicorp.com")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://www.terraform.io/language"},"Language reference for Terraform HCL")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://registry.terraform.io/providers/hashicorp/google/latest/docs"},"Terraform provider for Google Cloud"))),(0,o.kt)("p",null,"Fordeler med Terraform:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Infrastruktur blir reprodusertbart p\xe5 tvers av milj\xf8er"),(0,o.kt)("li",{parentName:"ul"},"Man f\xe5r bedre oversikt over hvilke endringer som utf\xf8res p\xe5 infrastruktur"),(0,o.kt)("li",{parentName:"ul"},"Man kan ta i bruk ferdige moduler for sett med ressurser som ofte h\xf8rer sammen, eller som alltid konfigureres p\xe5 et gitt vis. Se f.eks. ",(0,o.kt)("a",{parentName:"li",href:"https://github.com/svvsaga/terraform-modules"},"repoet 'terraform-modules' (krever innlogging)"),".")),(0,o.kt)("h2",{id:"terragrunt"},"Terragrunt"),(0,o.kt)("p",null,"N\xe5r man har mange ulike Terraform-moduler kan det bli mye boilerplate. Det er ogs\xe5 \xf8nskelig \xe5 kunne enkelt skifte mellom ulike milj\xf8er. ",(0,o.kt)("a",{parentName:"p",href:"https://terragrunt.gruntwork.io/"},"Terragrunt")," er et lite verkt\xf8y som wrapper Terraform med st\xf8tte for genererte filer, milj\xf8variabler og felles oppsett."),(0,o.kt)("h2",{id:"saga-team-template"},"saga-team-template"),(0,o.kt)("p",null,"Vi har laget et mal-repo, ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/svvsaga/saga-team-template"},"saga-team-template"),", som benytter Terraform for \xe5 sette opp en enkel ingest-pipeline. Her benyttes ogs\xe5 Terragrunt, for \xe5 hente ut og samle felles oppsett."),(0,o.kt)("p",null,"Det anbefales \xe5 se p\xe5 repoet for bruk av Terraform og Terragrunt, og gjerne pr\xf8v \xe5 sette opp pipelinen selv for ditt prosjekt."),(0,o.kt)("h2",{id:"import-av-eksisterende-infrastruktur-til-terraform"},"Import av eksisterende infrastruktur til Terraform"),(0,o.kt)("p",null,"Det er mulig \xe5 importere enkeltressurser som har blitt opprettet utenfor Terraform. Dette gj\xf8res ved \xe5 f\xf8rst skrive Terraform-koden som vanlig, deretter kj\xf8re ",(0,o.kt)("a",{parentName:"p",href:"https://www.terraform.io/cli/import"},(0,o.kt)("inlineCode",{parentName:"a"},"terraform import")," eller ",(0,o.kt)("inlineCode",{parentName:"a"},"terragrunt import")),"."),(0,o.kt)("p",null,"Dersom man er usikker p\xe5 hvordan Terraform-koden skal skrives, eller har et mer omfattende oppsett med mange ressurser man \xf8nsker \xe5 f\xe5 inn i Terraform, kan man benytte ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/GoogleCloudPlatform/terraformer"},(0,o.kt)("inlineCode",{parentName:"a"},"terraformer"))," fra Google: et CLI som lar deg spesifisere prosjekt og hvilke ressurstyper som skal importeres, og genererer Terraform-kode for disse."),(0,o.kt)("h2",{id:"alternativer-til-terraform"},"Alternativer til Terraform"),(0,o.kt)("p",null,"Terraform kan virke avskrekkende og av og til overkill. N\xe5r trenger man -ikke- Terraform?"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"I en utforskingsperiode kan det v\xe6re bedre \xe5 lage ressurser direkte i GCP Console. Dette har man tilganger til \xe5 gj\xf8re i teamets egne STM-prosjekt, samt i ditt personlige utvikler-sandbox-prosjekt. Bare husk at disse m\xe5 ryddes opp manuelt ogs\xe5."),(0,o.kt)("li",{parentName:"ul"},"Av og til har man behov for \xe5 opprette ressurser dynamisk/programmatisk, f.eks. en ingest-pipeline som lager nye midlertidige BigQuery-tabeller. I disse tilfellene gj\xf8res endringene av Service Account'en som pipelinen bruker, og denne m\xe5 ha f\xe5tt tildelt tilganger til \xe5 opprette ressurser."),(0,o.kt)("li",{parentName:"ul"},"Ved andre behov, ",(0,o.kt)("a",{parentName:"li",href:"https://vegvesen.slack.com/archives/C03LGD7TM5Z"},"kontakt plattformteamet Yggdrasil p\xe5 #saga-support"),".")),(0,o.kt)("p",null,"Dersom man \xf8nsker \xe5 beskrive infrastruktur i et kjent kodespr\xe5k som TypeScript, Java eller Python, heller enn Terraforms deklarative HCL-syntaks, finnes det to muligheter for dette:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},(0,o.kt)("a",{parentName:"strong",href:"https://www.terraform.io/cdktf"},"Cloud Development Kit for Terraform (CDKTF)"))," - HashiCorps egen l\xf8sning for \xe5 kunne skrive kode som genererer Terraform-oppsett. Fremdeles i preview, men virker lovende."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},(0,o.kt)("a",{parentName:"strong",href:"https://www.pulumi.com/"},"Pulumi"))," - Konkurrerende verkt\xf8y for Infrastructure as Code, med st\xf8tte for en rekke kodespr\xe5k. Vi har ingen erfaring med Pulumi, men tar gjerne imot synspunkter og erfaringer.")))}k.isMDXComponent=!0}}]);